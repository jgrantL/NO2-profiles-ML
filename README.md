# Efficient Prediction of NO2 Vertical Profiles Using ML

Welcome to my 8-month research project at a UC Berkeley [atmospheric chemistry lab](https://cohen.cchem.berkeley.edu/) under the guidance of Dr. Ron Cohen! 

## Introduction

In order to get an accurate retrieval of NO2 data from a satellite, scientists require a priori knowledge about where NO2 generally exists in the atmosphere. This a prior knowledge comes in the form of a vertical profile (see picture below for both urban and rural NO2 vertical profiles over Atlanta, GA). Traditionally, simulation of vertical profiles is done by a chemstry transport model (CTM), like NOAA's [Weather Research and Forecasting (WRF) model coupled with Chemistry](https://ruc.noaa.gov/wrf/wrf-chem/) (WRF-CHEM). However, simulations using a CTM take a long time and pose a potential problem for future generations of geostationary satellite instruments that make observations more frequently and at higher resolutions. 

Our project is a proof of concept that machine learning can be used to simulate a priori NO2 vertical profiles at both high spatial and high temporal resolution. Since the chemical simulation component of a CTM is the source of the bottleneck, our model uses exclusively as inputs meteorology and emissions data to predict where NO2 is present in the atmosphere over a given region. Our random forest model yields good results over rural and urban Atlanta, GA and we plan to scale the model up to incorporate the Continental United States.
<br>
<p align="center">
  <img height="200" width="250" src="average_both_profile.jpeg" />
  <br>
  <em>Where NO2 generally lies in the atmosphere for both urban and rural domains in Atlanta, GA</em>
</p>

## Repo Breakdown

- Code: This directory contains all my code used to extract, clean, and prepare our data for a random forest regression model. The files in this directory are only for our most recent urban and rural model over Atlanta, GA and so there are lots of code omitted from previous iterations of model training and testing. If you're interested, you can reach out to see more. 

- Presentations: This directory contains material I used to present my research at an invite-only science prep meeting for the TEMPO satellite launch in 2022. The audience was a wide arrange of research scientists from NASA, NOAA, Harvard, and the Smithsoninan.

- Data: This directory contains all data used for our urban and rural model. The directory is organized into subdirectories and showcase how I keep my files organized for a large-scale data science project. 

## Data Source

All of our data in the /data/raw_data/ subdirectory come from WRF-CHEM output over the years 2005, 2007 - 2009, 2011 - 2014 and include only the month of July. This output was generated by Dr. Cohen's lab for the use of their BErkeley High Resolution (BEHR) satellite retrieval product.

## Acknowledgement

I would like to thank Dr. Cohen for the incredibly opportunity to take this project and make it my own. I appreciate the consisten feedback and support Dr. Cohen has provided me over the last 8 months. 

I would also like to thank two of Dr. Cohen's graduate students: Hannah Kennagy and Qindan Zhu. These ladies were instrumental in moving this project forward by consistently providing support and loads of mentorship. I would not have enjoyed my experience as much as I did if I didn't have Hannah and Qindan by my side.
